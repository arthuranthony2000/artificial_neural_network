function out = layer(x, w, f)
    out = f(x * w');
end